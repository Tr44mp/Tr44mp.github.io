<!DOCTYPE html>
<html>
	<head></head>
	<body>gaming
		<div id='change'></div>
		<div id='base'></div>
		<div id='rotation'></div>
		<div id='gaming'></div>
		<input type='text' id='name' value='Tr4mp'>
		<button id="zero">zero</button>
		<script type="module">
		import * as THREE from 'https://cdn.skypack.dev/three@0.128.0'
		var euler = new THREE.Euler()
		var token = '0e1aea9e-9fc1-4af8-b0e0-25494cdef436'
		var session = '81b71f39-61fe-4699-80f8-25043cb02b40'
		var bx = 0
		var by = 0
		var bz = 0
		var tx = 0
		var ty = 0
		var tz = 0
		var x = 0
		var y = 0
		var z = 0
		var time = Date.now()
		var avg = 0
		var c = 1
		if ('RelativeOrientationSensor' in window) {
			let sensor = new RelativeOrientationSensor({frequency:20})
			sensor.addEventListener('reading', e => {
				var lim = sensor.quaternion[0]*sensor.quaternion[1] + sensor.quaternion[2]*sensor.quaternion[3]
				if (false/*lim > 0.499*/) {
					tx = 2 * Math.atan2(sensor.quaternion[0],sensor.quaternion[3])
					ty = Math.PI/2
					tz = 0
				}
				else if (false/*lim < -0.499*/) {
					tx = -2 * Math.atan2(sensor.quaternion[0],sensor.quaternion[3])
					ty = - Math.PI/2
					tz = 0
				}
				else {
					tx = Math.atan2(2*sensor.quaternion[1]*sensor.quaternion[3]-2*sensor.quaternion[0]*sensor.quaternion[2] , 1 - 2*(sensor.quaternion[1]*sensor.quaternion[1]) - 2*(sensor.quaternion[2]*sensor.quaternion[2]))
					ty = Math.asin(2*lim)
					tz = Math.atan2(2*sensor.quaternion[0]*sensor.quaternion[3]-2*sensor.quaternion[1]*sensor.quaternion[2] , 1 - 2*(sensor.quaternion[0]*sensor.quaternion[0]) - 2*(sensor.quaternion[2]*sensor.quaternion[2]))
				}
				euler = euler.setFromQuaternion(new THREE.Quaternion().fromArray(sensor.quaternion), 'XYZ')
				document.getElementById('change').innerHTML = 'x: ' + Math.floor(tx*(180/Math.PI)) + ' y: ' + Math.floor(ty*(180/Math.PI)) + ' z: ' + Math.floor(tz*(180/Math.PI))
				document.getElementById('base').innerHTML = 'x: ' + Math.floor(bx*(180/Math.PI)) + ' y: ' + Math.floor(by*(180/Math.PI)) + ' z: ' + Math.floor(bz*(180/Math.PI))
				x=((tx-bx)*(180/Math.PI))//%360
				y=((ty-by)*(180/Math.PI))//%360
				z=((tz-bz)*(180/Math.PI))//%360
				document.getElementById('rotation').innerHTML = 'x: ' + Math.floor(x) + ' y: ' + Math.floor(y) + ' z: ' + Math.floor(z)
				avg = (avg + (Date.now()-time))
				document.getElementById('gaming').innerHTML = "avg time: " + Math.floor(avg/c) + "ms c:" + c
				c++
				time = Date.now()
				var req = new XMLHttpRequest()
				req.open('POST', 'https://api.minehut.com/server/5ee263fd26d15f00510e1f1e/send_command', true)
				req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded')
				req.setRequestHeader('authorization', token)
				req.setRequestHeader('x-session-id', session)
				req.onload = function () {
					console.log(this.responseText)
				}
				req.send('command=execute as @e[tag=.'+document.getElementById('name').value+',type=armor_stand] run data merge entity @s {Pose:{Head:['+y*-1+'f,'+x*-1+'f,'+z*-1+'f]}}')
			})
			sensor.start()
		}
		var zero = document.getElementById("zero")
		zero.addEventListener("click", function() {
			bx=tx
			by=ty
			bz=tz
		})
		</script>
	</body>
</html>